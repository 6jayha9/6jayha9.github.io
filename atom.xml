<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://jayhablog.vercel.app</id>
    <title>Jayhaå°ç½—çš„ç§˜å¯†åŸºåœ°</title>
    <updated>2020-09-24T10:27:37.544Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://jayhablog.vercel.app"/>
    <link rel="self" href="https://jayhablog.vercel.app/atom.xml"/>
    <subtitle>æ¬¢è¿æ¥åˆ°Jayhaå°ç½—çš„Blogå˜»å˜»å˜»ï¼šï¼‰</subtitle>
    <logo>https://jayhablog.vercel.app/images/avatar.png</logo>
    <icon>https://jayhablog.vercel.app/favicon.ico</icon>
    <rights>All rights reserved 2020, Jayhaå°ç½—çš„ç§˜å¯†åŸºåœ°</rights>
    <entry>
        <title type="html"><![CDATA[spring-securityå®‰å…¨è®¤è¯æ¡†æ¶Part1ï¼ˆéOAuth2éƒ¨åˆ†ï¼‰]]></title>
        <id>https://jayhablog.vercel.app/spring-security-an-quan-ren-zheng-kuang-jia-1/</id>
        <link href="https://jayhablog.vercel.app/spring-security-an-quan-ren-zheng-kuang-jia-1/">
        </link>
        <updated>2020-09-13T11:09:48.000Z</updated>
        <content type="html"><![CDATA[<hr>
<p>spring-securityæ˜¯é€šè¿‡servletçš„filteré“¾æ–¹å¼å®ç°çš„ä¸€ç§è®¤è¯ï¼Œæˆæƒ<br>
<img src="https://jayhablog.vercel.app/post-images/1599995513270.png" alt="" loading="lazy"><br>
å¿«é€Ÿå…¥é—¨ï¼ˆåœ¨å†…å­˜ä¸­ä½¿ç”¨ï¼‰ï¼›</p>
<p>åœ¨å†…å­˜ä¸­çš„ä½¿ç”¨éå¸¸ç®€å•</p>
<p>é˜…è¯»ä»£ç å³å¯</p>
<pre><code class="language-java">@Configuration
@EnableWebSecurity
public class securityConfig extends WebSecurityConfigurerAdapter {

    @Bean
    public PasswordEncoder passwordEncoder() {
        // BCryptPasswordEncoderï¼šSpring Security æä¾›çš„åŠ å¯†å·¥å…·ï¼Œå¯å¿«é€Ÿå®ç°åŠ å¯†åŠ ç›
        return new BCryptPasswordEncoder();
    }
    @Bean
    public UserDetailsService userDetailsService(){
        InMemoryUserDetailsManager manager = new InMemoryUserDetailsManager();
        return  manager;
    }
    /**
     * è¯¥æ–¹æ³•æ˜¯æˆæƒç›¸å…³æ–¹æ³•
     * @param http
     * @throws Exception
     */
    @Override
    protected void configure(HttpSecurity http) throws Exception {
        //é¦–é¡µæ‰€æœ‰äººå¯ä»¥è®¿é—®&quot;/&quot;
        http.authorizeRequests()
                .antMatchers(&quot;/&quot;).permitAll()
                .antMatchers(&quot;/index.html&quot;).permitAll()
                .antMatchers(&quot;/index&quot;).permitAll()
                .antMatchers(&quot;/home&quot;).permitAll()
                .antMatchers(&quot;/welcome&quot;).permitAll()
                .antMatchers(&quot;/level1/**&quot;).hasRole(&quot;vip1&quot;)
                .antMatchers(&quot;/level2/**&quot;).hasRole(&quot;vip2&quot;)
                .antMatchers(&quot;/level3/**&quot;).hasRole(&quot;vip3&quot;)
        .and().formLogin()//å¼€å¯è‡ªå®šä¹‰é¡µé¢
                .loginPage(&quot;/userlogin&quot;).loginProcessingUrl(&quot;/welcome&quot;).usernameParameter(&quot;username&quot;).passwordParameter(&quot;password&quot;).
                failureHandler((req, resp, exception) -&gt; {
                    resp.setContentType(&quot;application/json;charset=utf-8&quot;);
                            PrintWriter out = resp.getWriter();
                            out.write(&quot;ç™»å½•å¤±è´¥...&quot;);
                    out.flush();
                })
                .permitAll()
                .and()
                .httpBasic()
                .and()
                // å…³é—­CSRFè·¨åŸŸ
                .csrf().disable();
        ;
        //æ²¡æœ‰æƒé™è·³åˆ°ç™»å½•é¡µ
        /*http.formLogin();*/
        //å…³é—­csrfåŠŸèƒ½
        //http.csrf().disable();
        //å¼€å¯æ³¨é”€ æˆåŠŸè·³åˆ°â€œ/â€
        http.logout().logoutSuccessUrl(&quot;/&quot;);
    }

    /**
     * è¯¥æ–¹æ³•æ˜¯è®¤è¯ç›¸å…³æ–¹æ³•
     * @param auth
     * @throws Exception
     */
    /*@Override
    protected void configure(AuthenticationManagerBuilder auth) throws Exception {
        //ä»å†…å­˜ä¸­è¯»
        //ä½¿ç”¨BCryptåŠ å¯†

        auth.inMemoryAuthentication().passwordEncoder(passwordEncoder())
                .withUser(&quot;jayha&quot;).password(passwordEncoder().encode(&quot;123456&quot;)).roles(&quot;vip3&quot;,&quot;vip2&quot;)
                .and()
                .withUser(&quot;nanha&quot;).password(passwordEncoder().encode(&quot;123456&quot;)).roles(&quot;vip1&quot;);

    }*/

    @Override
    public void configure(WebSecurity web) throws Exception {
        // è®¾ç½®æ‹¦æˆªå¿½ç•¥url - ä¼šç›´æ¥è¿‡æ»¤è¯¥url - å°†ä¸ä¼šç»è¿‡Spring Securityè¿‡æ»¤å™¨é“¾
        web.ignoring().antMatchers(&quot;/getUserInfo&quot;);
        // è®¾ç½®æ‹¦æˆªå¿½ç•¥æ–‡ä»¶å¤¹ï¼Œå¯ä»¥å¯¹é™æ€èµ„æºæ”¾è¡Œ
        web.ignoring().antMatchers(&quot;/css/**&quot;, &quot;/js/**&quot;);

    }
}
</code></pre>
<hr>
<hr>
<p>BCryptPasswordEncoder</p>
<p>æ˜¯springæä¾›çš„ä¸€ç§ç‰¹æ®ŠåŠ å¯†æ–¹å¼ï¼Œå»ºè®®æ•°æ®åº“ä»¥æ¬¡ç±»æ–¹å¼å­˜å‚¨ï¼Œæœ‰é™æ€æ–¹æ³•hashpw(å®é™…å¯†ç ï¼Œç›åˆ†å€¼[ä¹Ÿå¯ç”±Bcryptè‡ªåŠ¨ç”Ÿæˆ])</p>
<pre><code class="language-java">void testBcrypto(){
        String s1 = BCrypt.hashpw(&quot;sir159357&quot;, BCrypt.gensalt());
        String s2 = BCrypt.hashpw(&quot;sir159357&quot;, BCrypt.gensalt());

        System.out.println(s1);
        System.out.println(s2);
    }
</code></pre>
<p>ç»“æœ</p>
<pre><code class="language-tex">s1:$2a$10$WH2U/RLezICmMu8cAN2kQ.vWb46UOEtYbHgMeri8bc4JHGtKVGSKy

s2:$2a$10$aLTNf4pFC3OwyEM/r.9aeepuid9efVaLlvdqpNEDO01vPX.17kc0O
</code></pre>
<p>æ‰€ä»¥é…ç½®ä¸€ä¸ªåä¸ºpasswordEncoderçš„bean è¯¥beanè¿”å›çš„å€¼ å°±æ˜¯securityçš„ç¼–ç æ–¹å¼</p>
<pre><code class="language-java">@Bean
    public PasswordEncoder passwordEncoder() {
        // BCryptPasswordEncoderï¼šSpring Security æä¾›çš„åŠ å¯†å·¥å…·ï¼Œå¯å¿«é€Ÿå®ç°åŠ å¯†åŠ ç›
        return new BCryptPasswordEncoder();
    }
</code></pre>
<p>æ¥ä¸‹æ¥ æˆ‘ä»¬å°±å¯ä»¥ä»å†…å­˜è¿‡æ¸¡åˆ°æ•°æ®åº“äº†</p>
<p>å›åˆ°springsecurityæµç¨‹å›¾ æˆ‘ä»¬å¯ä»¥å‘ç°è®¤è¯æ˜¯ç”±ä¸€ä¸ªå«åšUserDetailsServiceçš„æ¥å£è¿›è¡Œå®ç°çš„ã€‚æˆ‘ä»¬å¯ä»¥å®ç°è¿™ä¸ªæ¥å£å¹¶æŠŠtaåŠ å…¥åˆ°IOCå®¹å™¨ä¸­</p>
<pre><code class="language-java">@Service
public class userdetailService implements UserDetailsService {

    @Autowired
    ItestuserDAO itestuserDAO;

    @Override
    public UserDetails loadUserByUsername(String s) throws UsernameNotFoundException {
        testuser one = itestuserDAO.findOneByAccount(s);
        if(one == null){
            return null;//ä¸ç”¨è‡ªå·±æŠ›å‡ºå¼‚å¸¸ è¿”å›NULL spring=securityä¼šè‡ªåŠ¨æ•´ç†
        }else{
            UserDetails details = User.withUsername(one.getAccount()).password(one.getPassword()).authorities(&quot;vip1&quot;).build();//withusernameæ–¹æ³•å³æŠŠusernameåŠ å…¥ passwordåŒç†ï¼Œauthoritiesåˆ™æ˜¯å°†ç”¨æˆ·è¿›è¡Œæˆæƒæ“ä½œ
            return details;
        }
    }
}
</code></pre>
<p>æ³¨æ„çš„æ˜¯è¿™é‡Œç»™ç”¨æˆ·æˆæƒçš„æ˜¯auth è€Œåœ¨SecurityConfigé‡Œé¢æ˜¯æˆæƒçš„role äºŒè€…æ˜¯ä¸åŒæˆæƒç†å¿µçš„å…·ä½“å®ç°ï¼Œç°åœ¨ä¸€èˆ¬æ˜¯roleï¼ˆè§’è‰²ï¼‰åŒ…å«authï¼ˆæƒé™ï¼‰è¿™ç§æ“ä½œ  è¦æ³¨æ„æ›´æ”¹</p>
<p><s>ä¿ºæœ€åˆæ²¡ç†è§£å¥½è¿™ä¸¤ä¸ªä¸œè¥¿çš„æ¦‚å¿µåœ¨è¿™ç–¯ç‹‚è¸©å‘</s></p>
<pre><code class="language-java">@Override
    protected void configure(HttpSecurity http) throws Exception {
        //é¦–é¡µæ‰€æœ‰äººå¯ä»¥è®¿é—®&quot;/&quot;
        http.authorizeRequests()
                .antMatchers(&quot;/&quot;).permitAll()
                .antMatchers(&quot;/index.html&quot;).permitAll()
                .antMatchers(&quot;/index&quot;).permitAll()
                .antMatchers(&quot;/home&quot;).permitAll()
                .antMatchers(&quot;/welcome&quot;).permitAll()
                .antMatchers(&quot;/level1/**&quot;).hasAuthority(&quot;vip1&quot;)
                .antMatchers(&quot;/level2/**&quot;).hasAuthority(&quot;vip2&quot;)
                .antMatchers(&quot;/level3/**&quot;).hasAuthority(&quot;vip3&quot;)
                .and()
                .formLogin()//å¼€å¯è‡ªå®šä¹‰é¡µé¢
                .loginPage(&quot;/userlogin&quot;)
                .loginProcessingUrl(&quot;/welcome&quot;)
                .usernameParameter(&quot;username&quot;)
                .passwordParameter(&quot;password&quot;)

                .failureHandler((req, resp, exception) -&gt; {
                    resp.setContentType(&quot;application/json;charset=utf-8&quot;);
                            PrintWriter out = resp.getWriter();
                            out.write(&quot;ç™»å½•å¤±è´¥...&quot;);
                    out.flush();
                }).permitAll()
                .and()
                .httpBasic()
                .and()
                // å…³é—­CSRFè·¨åŸŸ
                .csrf().disable().cors();
        ;
        http.logout().logoutSuccessUrl(&quot;/&quot;);
    }
</code></pre>
<h5 id="ç”¨æˆ·ç™»å½•åè·å–ç”¨æˆ·ä¿¡æ¯">ç”¨æˆ·ç™»å½•åè·å–ç”¨æˆ·ä¿¡æ¯</h5>
<p>å¯ä»¥ä½¿ç”¨</p>
<pre><code class="language-java">Authentication authentication =SecurityContextHolder.getContext().getAuthentication();
        Object principal = authentication.getPrincipal();
</code></pre>
<p>principalå°±æ˜¯UserDetailå¯¹è±¡ å¯ä»¥å¼ºè½¬åä½¿ç”¨å®ƒçš„å„ç§æ–¹æ³• æ¯”å¦‚è·å–å§“åï¼š</p>
<pre><code class="language-java"> @GetMapping(&quot;/getName&quot;)
    public String getUserAccount(){
        String account= null;
        Authentication authentication = SecurityContextHolder.getContext().getAuthentication();
        Object principal = authentication.getPrincipal();
        if(principal == null){
            account = &quot;åŒ¿å&quot;;
        }
        if(principal instanceof UserDetails){
            UserDetails u = (UserDetails)principal;
            account = u.getUsername();
        }
        return account;
    }
</code></pre>
<p>æ•°æ®åº“çš„å»ºç«‹ é™¤äº†ç”¨æˆ·ç±»å¤– è¿˜è¦æœ‰è§’è‰²è¡¨ ä¸ç”¨æˆ·è¡¨æ˜¯å¤šå¯¹å¤šå…³ç³» è¿˜è¦æœ‰æƒé™è¡¨ å’Œè§’è‰²è¡¨ä¹Ÿæ˜¯å¤šå¯¹å¤šå…³ç³»ç”±äºè¿™ä¸ªsqlæ¯”è¾ƒå¤æ‚ å»ºè®®ç”¨mybatis</p>
<p>ç”±äºæˆ‘ä»¬ä¹‹åä½¿ç”¨tokenæ¥ä¿æŒä¼šè¯ï¼Œæ‰€ä»¥ æˆ‘ä»¬å¯ä»¥å°†sessionä¿æŒä¼šè¯æ–¹å¼ç¦ç”¨</p>
<p><s>å»ºè®®åœ¨å­¦äº†tokenä¹‹åå†å…³</s></p>
<pre><code class="language-java">protected void configure(HttpSecurity http) throws Exception {http.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS);}
</code></pre>
<hr>
<h4 id="æ–¹æ³•æˆæƒ">æ–¹æ³•æˆæƒ</h4>
<p>åœ¨é…ç½®ç±»ä¸Šï¼ˆåŠ äº†configurationæ³¨è§£çš„ç±»ï¼‰ä½¿ç”¨</p>
<pre><code class="language-java">@EnableGlobalMethodSecurity(securedEnabled = true )
</code></pre>
<p>å¼€å¯æ–¹æ³•æˆæƒ securedæ³¨è§£APIæ”¯æŒ</p>
<pre><code class="language-java">@Secured(&quot;IS_AUTHENTICATED_ANONYMOUSLY&quot;)//å…è®¸åŒ¿åè®¿é—®çš„æ–¹æ³•ï¼ˆå³ä»»ä½•äººéƒ½å¯ä»¥è®¿é—®ï¼‰
@Secured(&quot;ROLE_xx&quot;)//åªæœ‰xxè§’è‰²çš„å¯ä»¥è®¿é—®

</code></pre>
<p>ä½†ä¸å»ºè®®ä½¿ç”¨è¿™ä¸ª</p>
<p>å»ºè®®ä½¿ç”¨prepostæ³¨è§£</p>
<pre><code class="language-java">@EnableGlobalMethodSecurity(securedEnabled = true,prePostEnabled = true)
</code></pre>
<pre><code class="language-java">@PreAuthorize(&quot;isAnonymous()&quot;) åŒ¿åå¯ä»¥è®¿é—®
@PreAuthorize(&quot;hasAuthority('vip1','vip2')&quot;)æœ‰vip1å’Œvip2çš„å¯ä»¥è®¿é—®
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[springbooté›†æˆå®šæ—¶ï¼Œå¼‚æ­¥ï¼Œé‚®ä»¶ä»»åŠ¡]]></title>
        <id>https://jayhablog.vercel.app/springboot-ji-cheng-ding-shi-yi-bu-you-jian-ren-wu/</id>
        <link href="https://jayhablog.vercel.app/springboot-ji-cheng-ding-shi-yi-bu-you-jian-ren-wu/">
        </link>
        <updated>2020-09-11T06:35:16.000Z</updated>
        <content type="html"><![CDATA[<h2 id="å¼‚æ­¥">å¼‚æ­¥</h2>
<hr>
<p>springbootä¸»ç±»ä¸‹ç”¨@EnableAsync å¼€å¯å¼‚æ­¥</p>
<p>åœ¨éœ€è¦ç”¨å¼‚æ­¥çš„æ–¹æ³•ä¸Šä½¿ç”¨@Asyncæ³¨è§£ï¼Œè¯¥ä»»åŠ¡ä¼šè‡ªåŠ¨è¿›å…¥ä¸€ä¸ªæ–°è¿›ç¨‹ï¼Œè‡ªåŠ¨å¼‚æ­¥</p>
<h2 id="é‚®ä»¶">é‚®ä»¶</h2>
<hr>
<p>jar</p>
<pre><code class="language-xml">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-mail --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;
&lt;/dependency&gt;

</code></pre>
<p>yamlé…ç½®ä¿¡æ¯</p>
<pre><code class="language-yaml">spring:
   mail:
     username: your_mail@xx.com
     password: your_password
     host: smtp.163.com  #example
     protocol: smtps   #example
</code></pre>
<p>springbootè‡ªåŠ¨è£…JavaMailSenderImplçš„å®ä½“ç±»</p>
<pre><code class="language-java">//æºç 
@Bean
    JavaMailSenderImpl mailSender(Session session) {
        JavaMailSenderImpl sender = new JavaMailSenderImpl();
        sender.setDefaultEncoding(this.properties.getDefaultEncoding().name());
        sender.setSession(session);
        return sender;
    }
</code></pre>
<p>æŒ‰ç…§é…ç½®æ–‡ä»¶çš„å±æ€§è¿›è¡Œåˆ›å»ºï¼Œå¯ä»¥ç›´æ¥æ³¨å…¥</p>
<pre><code class="language-java"> @Autowired
    private JavaMailSenderImpl mailSender;
</code></pre>
<p>ä¹‹åç›´æ¥ç”¨mailsenderæ‰€æä¾›çš„å„ç§sendè¿›è¡Œå‘é€å°±è¡Œ ç¤ºä¾‹ï¼š</p>
<pre><code class="language-java">@Test
    void contextLoads()  {
        SimpleMailMessage mailMessage = new SimpleMailMessage();
        mailMessage.setSubject(&quot;æ—©ä¸Šå¥½&quot;);
        mailMessage.setText(&quot;goodMoring&quot;);
        mailMessage.setTo(&quot;send_mail@qq.com&quot;);
        mailMessage.setFrom(&quot;your_mail@163.com&quot;);
        mailSender.send(mailMessage);
    }
</code></pre>
<p>è‹¥è¦å‘é€å¤æ‚é‚®ä»¶ åˆ™å¯ä»¥å–æ¶ˆsimpleMailMessageç±» ç”¨</p>
<pre><code class="language-java">MimeMessage mimeMessage = mailSender.createMimeMessage();
</code></pre>
<p>å¤æ‚ç±»å¯¹è±¡</p>
<pre><code class="language-java">        MimeMessageHelper helper = new MimeMessageHelper(mimeMessage, true);

        helper.setSubject(&quot;æ—©ä¸Šå¥½&quot;);
        helper.setText(&quot;&lt;a herf='www.baidu.com' &gt;ä»Šå¤© 7:30æ¥å¼€ä¼š&lt;/a&gt;&quot;,true);

        //å‘é€é™„ä»¶
        helper.addAttachment(&quot;1.jpg&quot;,new File(&quot;C:\\Users\\19029\\Desktop\\æ‚ä¸ƒæ‚å…«~\\1.jpg&quot;));

        helper.setTo(&quot;1902980268@qq.com&quot;);
        helper.setFrom(&quot;15999971548@163.com&quot;);
        mailSender.send(mimeMessage);
</code></pre>
<h2 id="å®šæ—¶">å®šæ—¶</h2>
<hr>
<p>é¡¹ç›®å¼€å‘ä¸­ç»å¸¸éœ€è¦æ‰§è¡Œä¸€äº›å®šæ—¶ä»»åŠ¡ï¼Œæ¯”å¦‚éœ€è¦åœ¨æ¯å¤©å‡Œæ™¨çš„æ—¶å€™ï¼Œåˆ†æä¸€æ¬¡å‰ä¸€å¤©çš„æ—¥å¿—ä¿¡æ¯ï¼ŒSpringä¸ºæˆ‘ä»¬æä¾›äº†å¼‚æ­¥æ‰§è¡Œä»»åŠ¡è°ƒåº¦çš„æ–¹å¼ï¼Œæä¾›äº†ä¸¤ä¸ªæ¥å£ã€‚</p>
<ul>
<li>TaskExecutoræ¥å£</li>
<li>TaskScheduleræ¥å£</li>
</ul>
<p>ä¸¤ä¸ªæ³¨è§£ï¼š</p>
<ul>
<li>@EnableScheduling// ä¸»mainæ–¹æ³•ä¸Š è¡¨ç¤ºå¼€å¯å®šæ—¶ä»»åŠ¡</li>
<li>@Scheduled//å†™cronè¡¨è¾¾å¼ è¡¨ç¤ºä»€ä¹ˆæ—¶å€™</li>
</ul>
<figure data-type="image" tabindex="1"><img src="C:%5CUsers%5C19029%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200911141657793.png" alt="image-20200911141657793" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[swaggeråˆæ­¥å®è·µ]]></title>
        <id>https://jayhablog.vercel.app/swagger-chu-bu-shi-jian/</id>
        <link href="https://jayhablog.vercel.app/swagger-chu-bu-shi-jian/">
        </link>
        <updated>2020-09-10T08:04:11.000Z</updated>
        <content type="html"><![CDATA[<h3 id="swagger">swagger</h3>
<hr>
<p>swagger jar</p>
<pre><code class="language-xml">&lt;!--swagger--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;io.springfox&lt;/groupId&gt;
            &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;
            &lt;version&gt;2.9.2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;!--http://localhost:8080/swagger-ui.html--&gt;
        &lt;!--&lt;dependency&gt;
            &lt;groupId&gt;io.springfox&lt;/groupId&gt;
            &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;
            &lt;version&gt;2.9.2&lt;/version&gt;
        &lt;/dependency&gt;--&gt;
        &lt;!--http://localhost:8080/document.html--&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.zyplayer&lt;/groupId&gt;
            &lt;artifactId&gt;swagger-mg-ui&lt;/artifactId&gt;
            &lt;version&gt;1.0.6&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre>
<p><em>swaggerçš„springbootå†…ç±»é…ç½®</em></p>
<pre><code class="language-java">package cn.gdoujayha.springbootApplication.config;

import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.core.env.Environment;
import org.springframework.core.env.Profiles;
import springfox.documentation.builders.PathSelectors;
import springfox.documentation.builders.RequestHandlerSelectors;
import springfox.documentation.service.ApiInfo;
import springfox.documentation.service.Contact;
import springfox.documentation.spi.DocumentationType;
import springfox.documentation.spring.web.plugins.Docket;
import springfox.documentation.swagger2.annotations.EnableSwagger2;

import java.util.ArrayList;
import java.util.Properties;


@Configuration
@EnableSwagger2
public class SwaggerConfig {

    /**
     * è”ç³»æ–¹å¼ï¼ˆä½œè€…åå­—ï¼Œè”ç³»urlï¼Œemailï¼‰
     */
    private static final Contact CONTACT = new Contact(&quot;jayha&quot;,&quot;https://jayhablog.vercel.app&quot;,&quot;1902980268@qq.com&quot;) ;

    /*
        é…ç½®swaggerçš„docket beanå®ä¾‹
         */
    @Bean
    /*@ConditionalOnProperty(prefix = &quot;profiles&quot;,havingValue = &quot;dev&quot;)*/
    public Docket docket(Environment environment){


        Profiles profiles = Profiles.of(&quot;dev&quot;,&quot;test&quot;);
        boolean flag = environment.acceptsProfiles(profiles);//â€œä»…åœ¨devå’Œtestç¯å¢ƒä¸‹ç”Ÿæ•ˆâ€


       return  new Docket(DocumentationType.SWAGGER_2)
                .groupName(&quot;jayha&quot;)//è®¾ç½®åˆ†ç»„å å¯ä»¥è®¾ç½®å¤šä¸ªåˆ†ç»„ï¼ˆå¤šäººååŒçš„æ—¶å€™ï¼Œå¯ä»¥ä¸€äººä¸€ä¸ªæˆ–å¤šä¸ªç»„ï¼‰
                .enable(flag)
                .apiInfo(apiInfo())
                .select()
                /**
                 * apisï¼šé…ç½®æ‰€éœ€è¦æ‰«æçš„åœ°æ–¹
                 * requestHandlerSelectorsæœ‰æ–¹å¼
                 * .basePackageé…ç½®æ‰«æåŒ…
                 * .anyæ‰«ææ‰€æœ‰åœ°æ–¹
                 * .noneå…¨ä¸æ‰«æ
                 * .withClassAnnotation()åªæ‰«æç±»ä¸Šæœ‰åŠ äº†ä¼ å…¥æ³¨è§£classçš„çš„é‚£ä¸ªæ³¨è§£çš„ç±»ï¼ˆä¼ å…¥æ³¨è§£çš„classï¼‰
                 */
                .apis(RequestHandlerSelectors.basePackage(&quot;cn.gdoujayha.springbootApplication.controller&quot;))//é…ç½®æ‰«æåŒ…
                /**
                 * pathsé…ç½®è¿‡æ»¤çš„è·¯å¾„
                 * ä½¿ç”¨pathselectorä¸‹çš„ä¸œè¥¿
                 * ä¸‹æœ‰ï¼š
                 * anyå…¨éƒ¨
                 * noneå…¨å¦
                 * regexï¼šæ­£åˆ™
                 * antï¼ˆä¸€èˆ¬ç”¨è¿™ä¸ªï¼‰è·¯å¾„
                 */
                //.paths(PathSelectors.ant(&quot;/springbootApplication/controller/reginController/**&quot;))
                .build()
                ;
    }

    /**
     * apiinfoçš„é…ç½®
     * @return
     */
    private ApiInfo apiInfo(){
        return new ApiInfo(&quot;Jayhaâ€˜æ–‡æ¡£&quot;,
                &quot;å…³äº''é¡¹ç›®çš„swaggeræ–‡æ¡£&quot;,
                &quot;0.1&quot;,
                &quot;urn:tos&quot;,
                CONTACT,
                &quot;Apache 2.0&quot;,
                &quot;http://www.apache.org/licenses/LICENSE-2.0&quot;,
                new ArrayList());
    }
}

</code></pre>
<blockquote>
<h3 id="å¸¸ç”¨æ³¨è§£">å¸¸ç”¨æ³¨è§£</h3>
</blockquote>
<p>Swaggerçš„æ‰€æœ‰æ³¨è§£å®šä¹‰åœ¨io.swagger.annotationsåŒ…ä¸‹</p>
<p>ä¸‹é¢åˆ—ä¸€äº›ç»å¸¸ç”¨åˆ°çš„ï¼Œæœªåˆ—ä¸¾å‡ºæ¥çš„å¯ä»¥å¦è¡ŒæŸ¥é˜…è¯´æ˜ï¼š</p>
<table>
<thead>
<tr>
<th>Swaggeræ³¨è§£</th>
<th style="text-align:center">ç®€å•è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>@Api(tags = &quot;xxxæ¨¡å—è¯´æ˜&quot;)</td>
<td style="text-align:center">ä½œç”¨åœ¨æ¨¡å—ç±»ä¸Š</td>
</tr>
<tr>
<td>@ApiOperation(&quot;xxxæ¥å£è¯´æ˜&quot;)</td>
<td style="text-align:center">ä½œç”¨åœ¨æ¥å£æ–¹æ³•ä¸Š</td>
</tr>
<tr>
<td>@ApiModel(&quot;xxxPOJOè¯´æ˜&quot;)</td>
<td style="text-align:center">ä½œç”¨åœ¨æ¨¡å‹ç±»ä¸Šï¼šå¦‚VOã€BO</td>
</tr>
<tr>
<td>@ApiModelProperty(value = &quot;xxxå±æ€§è¯´æ˜&quot;,hidden = true)</td>
<td style="text-align:center">ä½œç”¨åœ¨ç±»æ–¹æ³•å’Œå±æ€§ä¸Šï¼Œhiddenè®¾ç½®ä¸ºtrueå¯ä»¥éšè—è¯¥å±æ€§</td>
</tr>
<tr>
<td>@ApiParam(&quot;xxxå‚æ•°è¯´æ˜&quot;)</td>
<td style="text-align:center">ä½œç”¨åœ¨å‚æ•°ã€æ–¹æ³•å’Œå­—æ®µä¸Šï¼Œç±»ä¼¼@ApiModelProperty</td>
</tr>
</tbody>
</table>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å…³äºæœ¬ç«™]]></title>
        <id>https://jayhablog.vercel.app/guan-yu-ben-zhan/</id>
        <link href="https://jayhablog.vercel.app/guan-yu-ben-zhan/">
        </link>
        <updated>2020-08-04T04:49:58.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p>æ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™å‘€ï¼Œå¾ˆé«˜å…´é‡è§ä½ ï¼ğŸ¤</p>
</blockquote>
<h2 id="å…³äºæœ¬ç«™">ğŸ  å…³äºæœ¬ç«™ï¼š</h2>
<p>è¿™æ˜¯Jayhaå°ç½—åŒå­¦æ— èŠä¹‹ä¸‹åšçš„ä¸€ä¸ªç®€é™‹åšå®¢ï¼Œæ—¨åœ¨åˆ†äº«æŠ€æœ¯ï¼Œå€¾ååƒåœ¾ï¼Œå†™çŸ«æƒ…æ–‡å­—å˜»å˜»å˜»ã€‚<br>
æˆ‘ä¹Ÿä¸çŸ¥é“æˆ‘ç»´æŠ¤å¤šä¹…ï¼Œå¯èƒ½å†™å‡ ç¯‡ä¹‹åå°±ä¸å†™äº†ï¼ˆæ‡’é¬¼æœ¬é¬¼è°¢è°¢!ï¼‰ä¹Ÿå¯èƒ½å¤§å­¦å››å¹´é‡Œä¸€ç›´ç»´æŠ¤ä»–ï¼Œå°†å°±çœ‹å§hhhhhã€‚</p>
<h2 id="å…´è¶£çˆ±å¥½">â›¹ å…´è¶£çˆ±å¥½</h2>
<p>è·³èˆå”±æ­Œæ•²ä»£ç ï¼ï¼ï¼</p>
<h2 id="è”ç³»æˆ‘å‘€">ğŸ“¬ è”ç³»æˆ‘å‘€</h2>
<p>å¾®ä¿¡å·: Jayha_<br>
giteeï¼šhttps://gitee.com/jayha</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç®€æ˜“å¿«é€Ÿspringbootæ•´åˆmybatsæ­¥éª¤]]></title>
        <id>https://jayhablog.vercel.app/springboot-zheng-he-mybats-jian-yi/</id>
        <link href="https://jayhablog.vercel.app/springboot-zheng-he-mybats-jian-yi/">
        </link>
        <updated>2020-08-03T15:25:41.000Z</updated>
        <content type="html"><![CDATA[<h2 id=""></h2>
<p>`mybatisæ•´åˆ</p>
<p>å¯¼å…¥åŒ…ä¸ç”¨è¯´</p>
<p>åœ¨ä¸»è¿è¡Œç±»ä¸Š åŠ ä¸Šè¿™ä¸ªæ³¨è§£ï¼Œè¡¨ç¤ºç»™è¿™ä¸ªåŒ…éƒ½åŠ ä¸Šmapperæ³¨è§£</p>
<p>åœ¨yamlæ–‡ä»¶ä¸Šé…ç½®mybatisé…ç½®</p>
<pre><code class="language-java">@MapperScan(basePackages ={&quot;cn.gdouJayha.springbootApplication.dao&quot;})
</code></pre>
<pre><code class="language-yaml">mybatis:
  #èµ·åˆ«å
  type-aliases-package: cn.gdouJayha.springbootapplication.domain
  #æ˜ å°„ä½ç½®
  mapper-locations: classpath:mybatis/mapper/*.xml
  
  check-config-location: true
  #ä¸»é…ç½®xmlä½ç½®
  config-location: classpath:mybatis/SqlMapConfig.xml
</code></pre>
<h2 id="-2"></h2>
<p>æ›´æ”¹pom.xml</p>
<pre><code class="language-xml">&lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
        &lt;resources&gt;
            &lt;resource&gt;
                &lt;directory&gt;src/main/resources&lt;/directory&gt;
                &lt;!-- src/main/resourcesä¸‹çš„æŒ‡å®šèµ„æºæ”¾è¡Œ --&gt;
                &lt;includes&gt;
                    &lt;include&gt;**/*.*&lt;/include&gt;
                &lt;/includes&gt;
                &lt;filtering&gt;false&lt;/filtering&gt;
            &lt;/resource&gt;
        &lt;/resources&gt;
    &lt;/build&gt;
</code></pre>
<p>å¦‚æœéœ€è¦ç”¨åˆ°äº‹åŠ¡å°½é‡ç”¨<br>
@EnableTransactionManagementå¼€å¯äº‹åŠ¡</p>
<pre><code class="language-java">@Transactional
</code></pre>
<p>è¯¥æ³¨è§£æ”¾åœ¨æ–¹æ³•ä¸Šå¼€å¯äº‹åŠ¡</p>
]]></content>
    </entry>
</feed>